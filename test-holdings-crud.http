### Holdings API CRUD Operations Test File
### Use this file to test the new holdings CRUD endpoints

@baseUrl = https://localhost:7001/api/holdings
@portfolioId = 1
@holdingId = 1

### 1. Get current holdings (existing endpoint - for reference)
GET {{baseUrl}}/date/2025-11-25
Authorization: Bearer YOUR_JWT_TOKEN_HERE

### 2. Add a new holding to portfolio
POST {{baseUrl}}/portfolio/{{portfolioId}}
Content-Type: application/json
Authorization: Bearer YOUR_JWT_TOKEN_HERE

{
  "platformId": 1,
  "ticker": "MSFT",
  "units": 50.0,
  "boughtValue": 17500.00,
  "instrumentName": "Microsoft Corporation",
  "description": "Technology stock",
  "currencyCode": "USD",
  "quoteUnit": "USD"
}

### 3. Update holding units
PUT {{baseUrl}}/{{holdingId}}/units
Content-Type: application/json
Authorization: Bearer YOUR_JWT_TOKEN_HERE

{
  "units": 75.5
}

### 4. Delete a holding
DELETE {{baseUrl}}/{{holdingId}}
Authorization: Bearer YOUR_JWT_TOKEN_HERE

### Expected Responses:

### Add Holding Response (201 Created):
# {
#   "success": true,
#   "message": "Successfully added 50.0000 units of MSFT to portfolio",
#   "errors": [],
#   "holdingId": 123,
#   "instrumentCreated": true,
#   "instrument": {
#     "id": 456,
#     "ticker": "MSFT",
#     "name": "Microsoft Corporation",
#     "description": "Technology stock",
#     "currencyCode": "USD"
#   },
#   "currentPrice": 420.50,
#   "currentValue": 21025.00
# }

### Update Holding Response (200 OK):
# {
#   "success": true,
#   "message": "Successfully updated MSFT units from 50.0000 to 75.5000",
#   "errors": [],
#   "holdingId": 123,
#   "previousUnits": 50.0,
#   "newUnits": 75.5,
#   "previousCurrentValue": 21025.00,
#   "newCurrentValue": 31737.75,
#   "ticker": "MSFT"
# }

### Delete Holding Response (200 OK):
# {
#   "success": true,
#   "message": "Successfully deleted holding for MSFT",
#   "errors": [],
#   "deletedHoldingId": 123,
#   "deletedTicker": "MSFT",
#   "portfolioId": 1
# }

### Error Responses:

### 400 Bad Request - Validation Error:
# {
#   "type": "https://tools.ietf.org/html/rfc9110#section-15.5.1",
#   "title": "Add Holding Failed",
#   "status": 400,
#   "detail": "Validation failed"
# }

### 404 Not Found - Portfolio/Holding Not Found:
# {
#   "type": "https://tools.ietf.org/html/rfc9110#section-15.5.5",
#   "title": "Portfolio Not Found",
#   "status": 404,
#   "detail": "Portfolio not found or does not belong to your account"
# }

### 409 Conflict - Duplicate Holding:
# {
#   "type": "https://tools.ietf.org/html/rfc9110#section-15.5.10",
#   "title": "Duplicate Holding", 
#   "status": 409,
#   "detail": "A holding for MSFT already exists in this portfolio for the current valuation date"
# }