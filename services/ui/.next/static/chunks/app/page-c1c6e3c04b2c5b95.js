(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{3162:function(e,t,a){Promise.resolve().then(a.bind(a,3886))},3886:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return F}});var l=a(7437),s=a(2265),i=a(891),n=a(257);class r{async getHoldings(e,t){try{let a=this.formatDate(t),l="".concat(this.baseUrl,"/api/holdings/account/").concat(e,"/date/").concat(a);console.log("Fetching holdings from: ".concat(l));let s=await fetch(l,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!s.ok){let e=await s.text();throw Error("HTTP ".concat(s.status,": ").concat(e))}let i=(await s.json()).holdings||[];return{data:i,message:"Successfully retrieved ".concat(i.length," holdings")}}catch(e){return console.error("Error fetching holdings:",e),{error:e instanceof Error?e.message:"Unknown error occurred"}}}async getHealthStatus(){try{let e="".concat(this.baseUrl,"/health");console.log("Attempting to connect to API health endpoint: ".concat(e)),console.log("Base URL configured as: ".concat(this.baseUrl));let t=await fetch(e);if(!t.ok)throw Error("Health check failed: ".concat(t.status));let a=await t.text();return console.log("API health check successful: ".concat(a)),{data:{status:a},message:"API is healthy"}}catch(e){return console.error("Health check failed:",e),console.error("Base URL was:",this.baseUrl),{error:e instanceof Error?e.message:"Health check failed"}}}formatDate(e){return new Date(e).toISOString().split("T")[0]}async testConnection(){return!(await this.getHealthStatus()).error}constructor(e){var t,a;let l=n.env.NEXT_PUBLIC_API_BASE_URL,s=(null===(a=window.location)||void 0===a?void 0:null===(t=a.origin)||void 0===t?void 0:t.replace("3000","8080"))||"http://localhost:8080";this.baseUrl=(e||l||s).replace(/\/$/,"")}}let c=new r,o=e=>new Intl.NumberFormat("en-GB",{style:"currency",currency:"GBP",minimumFractionDigits:2,maximumFractionDigits:2}).format(e),d=e=>new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:4}).format(e),m=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),h=()=>[{field:"portfolioName",headerName:"Portfolio",width:150,sortable:!0,filter:!0,pinned:"left"},{field:"instrumentName",headerName:"Instrument",width:200,sortable:!0,filter:!0,tooltipField:"instrumentName"},{field:"ticker",headerName:"Ticker",width:100,sortable:!0,filter:!0,cellStyle:{fontFamily:"monospace",fontWeight:"bold"}},{field:"isin",headerName:"ISIN",width:120,sortable:!0,filter:!0,cellStyle:{fontFamily:"monospace",fontWeight:"bold"},hide:!0},{field:"instrumentType",headerName:"Type",width:120,sortable:!0,filter:!0,hide:!0},{field:"unitAmount",headerName:"Units",width:120,sortable:!0,filter:"agNumberColumnFilter",type:"numericColumn",valueFormatter:e=>d(e.value),cellStyle:{textAlign:"right",fontFamily:"monospace"}},{field:"boughtValue",headerName:"Bought Value",width:130,sortable:!0,filter:"agNumberColumnFilter",type:"numericColumn",valueFormatter:e=>o(e.value),cellStyle:{textAlign:"right",fontFamily:"monospace"}},{field:"currentValue",headerName:"Current Value",width:140,sortable:!0,filter:"agNumberColumnFilter",type:"numericColumn",valueFormatter:e=>o(e.value),cellStyle:e=>({textAlign:"right",fontFamily:"monospace",fontWeight:"bold",color:e.value>0?"#10b981":"#ef4444"})},{field:"gainLoss",headerName:"Gain/Loss",width:130,sortable:!0,filter:"agNumberColumnFilter",type:"numericColumn",valueFormatter:e=>o(e.value),cellStyle:e=>({textAlign:"right",fontFamily:"monospace",fontWeight:"bold",color:e.value>=0?"#10b981":"#ef4444"})},{field:"gainLossPercentage",headerName:"Gain/Loss %",width:120,sortable:!0,filter:"agNumberColumnFilter",type:"numericColumn",valueFormatter:e=>"".concat(d(e.value),"%"),cellStyle:e=>({textAlign:"right",fontFamily:"monospace",fontWeight:"bold",color:e.value>=0?"#10b981":"#ef4444"})},{field:"platformName",headerName:"Platform",width:130,sortable:!0,filter:!0},{field:"valuationDate",headerName:"Valuation Date",width:140,sortable:!0,filter:"agDateColumnFilter",valueFormatter:e=>m(e.value)}],x=e=>e.reduce((e,t)=>e+t.currentValue,0);var u=a(370),f=a(7168),g=a(5255),p=a(525),b=a(1047),N=a(3247);a(4868),a(3893);let j=e=>{let{accountId:t}=e,[a,n]=(0,s.useState)([]),[r,d]=(0,s.useState)(!1),[m,j]=(0,s.useState)(null),[w,v]=(0,s.useState)(new Date().toISOString().split("T")[0]),y=(0,s.useCallback)(async()=>{d(!0),j(null);try{let e=await c.getHoldings(t,w);e.error?(j(e.error),n([])):n(e.data||[])}catch(e){j("Failed to fetch holdings"),n([])}finally{d(!1)}},[t,w]);(0,s.useEffect)(()=>{y()},[y]);let S=x(a),C=a.length;return(0,l.jsxs)("div",{className:"w-full h-full bg-white rounded-xl shadow-financial-lg border border-financial-gray-300",children:[(0,l.jsxs)("div",{className:"bg-gradient-to-r from-primary-600 to-primary-700 rounded-t-xl p-6 text-white",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)(u.Z,{className:"h-8 w-8"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-2xl font-bold",children:"Portfolio Holdings"}),(0,l.jsxs)("p",{className:"text-primary-100",children:["Account: ",t]})]})]}),(0,l.jsxs)("button",{onClick:y,disabled:r,className:"flex items-center space-x-2 bg-white/20 hover:bg-white/30 px-4 py-2 rounded-lg transition-colors duration-200",children:[(0,l.jsx)(f.Z,{className:"h-4 w-4 ".concat(r?"animate-spin":"")}),(0,l.jsx)("span",{children:"Refresh"})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[(0,l.jsx)("div",{className:"bg-white/10 rounded-lg p-4 backdrop-blur-sm",children:(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)(g.Z,{className:"h-6 w-6 text-financial-green"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-primary-100",children:"Total Value"}),(0,l.jsx)("p",{className:"text-xl font-bold",children:o(S)})]})]})}),(0,l.jsx)("div",{className:"bg-white/10 rounded-lg p-4 backdrop-blur-sm",children:(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)(p.Z,{className:"h-6 w-6 text-financial-blue"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-primary-100",children:"Holdings Count"}),(0,l.jsx)("p",{className:"text-xl font-bold",children:C})]})]})}),(0,l.jsx)("div",{className:"bg-white/10 rounded-lg p-4 backdrop-blur-sm",children:(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)(b.Z,{className:"h-6 w-6 text-financial-yellow"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-primary-100",children:"Valuation Date"}),(0,l.jsx)("input",{type:"date",value:w,onChange:e=>v(e.target.value),className:"bg-transparent border-b border-white/30 text-white placeholder-primary-200 focus:border-white focus:outline-none text-lg font-semibold"})]})]})})]}),(0,l.jsx)("div",{className:"flex justify-center",children:(0,l.jsxs)("button",{onClick:y,disabled:r,className:"flex items-center space-x-2 bg-white text-primary-600 hover:bg-primary-50 px-6 py-3 rounded-lg font-semibold transition-colors duration-200 shadow-lg",children:[(0,l.jsx)(N.Z,{className:"h-5 w-5"}),(0,l.jsx)("span",{children:r?"Loading...":"Search Holdings"})]})})]}),(0,l.jsxs)("div",{className:"p-6",children:[m&&(0,l.jsx)("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:(0,l.jsxs)("div",{className:"flex items-center space-x-2 text-red-700",children:[(0,l.jsx)("svg",{className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,l.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),(0,l.jsxs)("span",{className:"font-medium",children:["Error: ",m]})]})}),(0,l.jsx)("div",{className:"ag-theme-alpine w-full",style:{height:"600px"},children:(0,l.jsx)(i.s,{rowData:a,columnDefs:h(),defaultColDef:{sortable:!0,filter:!0,resizable:!0,minWidth:100},pagination:!0,paginationPageSize:50,rowSelection:"multiple"})}),a.length>0&&(0,l.jsx)("div",{className:"mt-6 bg-financial-gray-50 rounded-lg p-4",children:(0,l.jsxs)("div",{className:"flex justify-between items-center text-sm text-financial-gray-600",children:[(0,l.jsxs)("span",{children:["Showing ",a.length," holdings"]}),(0,l.jsxs)("span",{className:"font-semibold",children:["Total Portfolio Value: ",(0,l.jsx)("span",{className:"text-financial-green text-lg",children:o(S)})]})]})})]})]})};var w=a(8420),v=a(1671),y=a(9322),S=a(257);let C="49bc4123-5312-43d9-81bd-6c6f81e80bac";function F(){let[e,t]=(0,s.useState)("checking");return(0,s.useEffect)(()=>{(async()=>{try{let e=await c.testConnection();t(e?"online":"offline")}catch(e){t("offline")}})()},[]),(0,l.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-financial-gray-50 to-financial-gray-100",children:[(0,l.jsx)("header",{className:"bg-white shadow-financial border-b border-financial-gray-200",children:(0,l.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)(w.Z,{className:"h-8 w-8 text-primary-600"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-2xl font-bold text-financial-gray-900",children:"Portfolio Manager"}),(0,l.jsx)("p",{className:"text-sm text-financial-gray-500",children:"Professional Investment Management"})]})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:["checking"===e&&(0,l.jsxs)("div",{className:"flex items-center space-x-2 text-financial-gray-500",children:[(0,l.jsx)("div",{className:"animate-spin h-4 w-4 border-2 border-financial-gray-300 border-t-primary-600 rounded-full"}),(0,l.jsx)("span",{className:"text-sm",children:"Checking API..."})]}),"online"===e&&(0,l.jsxs)("div",{className:"flex items-center space-x-2 text-financial-green",children:[(0,l.jsx)(v.Z,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"text-sm font-medium",children:"API Online"})]}),"offline"===e&&(0,l.jsxs)("div",{className:"flex items-center space-x-2 text-financial-red",children:[(0,l.jsx)(y.Z,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"text-sm font-medium",children:"API Offline"})]})]})]})})}),(0,l.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:["offline"===e&&(0,l.jsx)("div",{className:"mb-8 bg-red-50 border border-red-200 rounded-xl p-6",children:(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)(y.Z,{className:"h-6 w-6 text-red-500"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-red-800",children:"API Connection Error"}),(0,l.jsx)("p",{className:"text-red-600 mt-1",children:"Unable to connect to the Portfolio Manager API. Please ensure the API service is running and accessible."}),(0,l.jsxs)("p",{className:"text-sm text-red-500 mt-2",children:["Expected API endpoint: ",S.env.NEXT_PUBLIC_API_BASE_URL||"http://localhost:8080"]})]})]})}),(0,l.jsx)("div",{className:"bg-white rounded-xl shadow-financial-lg overflow-hidden",children:(0,l.jsx)(j,{accountId:C})}),(0,l.jsx)("footer",{className:"mt-12 text-center text-financial-gray-500",children:(0,l.jsxs)("div",{className:"bg-white rounded-lg p-6 shadow-financial",children:[(0,l.jsx)("p",{className:"text-sm",children:"Portfolio Manager v1.0 - Built with Next.js, TypeScript, and AG Grid"}),(0,l.jsxs)("p",{className:"text-xs mt-2",children:["Account ID: ",C]})]})})]})]})}}},function(e){e.O(0,[292,884,314,828,971,117,744],function(){return e(e.s=3162)}),_N_E=e.O()}]);