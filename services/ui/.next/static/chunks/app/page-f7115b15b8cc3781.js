(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{3162:function(e,t,s){Promise.resolve().then(s.bind(s,3967))},3967:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return H}});var a=s(7437),r=s(2265),l=s(891),n=s(257);class i{async getHoldings(e,t){try{let s=this.formatDate(t),a="".concat(this.baseUrl,"/api/holdings/account/").concat(e,"/date/").concat(s);console.log("Fetching holdings from: ".concat(a));let r=await fetch(a,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!r.ok){let e=await r.text();throw Error("HTTP ".concat(r.status,": ").concat(e))}let l=(await r.json()).holdings||[];return{data:l,message:"Successfully retrieved ".concat(l.length," holdings")}}catch(e){return console.error("Error fetching holdings:",e),{error:e instanceof Error?e.message:"Unknown error occurred"}}}async getHealthStatus(){try{let e="".concat(this.baseUrl,"/health");console.log("Attempting to connect to API health endpoint: ".concat(e)),console.log("Base URL configured as: ".concat(this.baseUrl));let t=await fetch(e);if(!t.ok)throw Error("Health check failed: ".concat(t.status));let s=await t.text();return console.log("API health check successful: ".concat(s)),{data:{status:s},message:"API is healthy"}}catch(e){return console.error("Health check failed:",e),console.error("Base URL was:",this.baseUrl),{error:e instanceof Error?e.message:"Health check failed"}}}formatDate(e){return new Date(e).toISOString().split("T")[0]}async testConnection(){return!(await this.getHealthStatus()).error}async sendChatQueryStream(e,t,s,a,r){try{var l;let r="".concat(this.baseUrl,"/api/ai/chat/stream");console.log("Sending streaming chat query to: ".concat(r));let n=await fetch(r,{method:"POST",headers:{Accept:"text/plain","Content-Type":"application/json"},body:JSON.stringify({query:e,accountId:t})});if(!n.ok){let e=await n.text();throw Error("HTTP ".concat(n.status,": ").concat(e))}let i=null===(l=n.body)||void 0===l?void 0:l.getReader();if(!i)throw Error("ReadableStream not supported");let o=new TextDecoder;try{for(;;){let{done:e,value:t}=await i.read();if(e){a();break}let r=o.decode(t,{stream:!0});s(r)}}finally{i.releaseLock()}}catch(e){console.error("Error in streaming chat query:",e),r(e instanceof Error?e.message:"Unknown error occurred")}}async sendChatQuery(e,t){try{let s="".concat(this.baseUrl,"/api/ai/chat/query");console.log("Sending chat query to: ".concat(s));let a=await fetch(s,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({query:e,accountId:t})});if(!a.ok){let e=await a.text();throw Error("HTTP ".concat(a.status,": ").concat(e))}return{data:await a.json(),message:"Chat query processed successfully"}}catch(e){return console.error("Error sending chat query:",e),{error:e instanceof Error?e.message:"Unknown error occurred"}}}async getAvailableAiTools(){try{let e="".concat(this.baseUrl,"/api/ai/chat/tools");console.log("Fetching AI tools from: ".concat(e));let t=await fetch(e,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!t.ok){let e=await t.text();throw Error("HTTP ".concat(t.status,": ").concat(e))}let s=await t.json();return{data:s,message:"Successfully retrieved ".concat(s.length," AI tools")}}catch(e){return console.error("Error fetching AI tools:",e),{error:e instanceof Error?e.message:"Unknown error occurred"}}}async getChatHealthStatus(){try{let e="".concat(this.baseUrl,"/api/ai/chat/health");console.log("Checking AI chat health: ".concat(e));let t=await fetch(e,{method:"GET",headers:{Accept:"application/json"}});if(!t.ok)throw Error("AI chat health check failed: ".concat(t.status));return{data:await t.json(),message:"AI chat service is healthy"}}catch(e){return console.error("AI chat health check failed:",e),{error:e instanceof Error?e.message:"AI chat health check failed"}}}constructor(e){var t,s;let a=n.env.NEXT_PUBLIC_API_BASE_URL,r=(null===(s=window.location)||void 0===s?void 0:null===(t=s.origin)||void 0===t?void 0:t.replace("3000","8080"))||"http://localhost:8080";this.baseUrl=(e||a||r).replace(/\/$/,"")}}let o=new i,c=e=>new Intl.NumberFormat("en-GB",{style:"currency",currency:"GBP",minimumFractionDigits:2,maximumFractionDigits:2}).format(e),d=e=>new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:4}).format(e),m=e=>new Date(e).toLocaleDateString("en-GB",{year:"numeric",month:"short",day:"numeric"}),h=()=>[{field:"portfolioName",headerName:"Portfolio",width:150,sortable:!0,filter:!0,pinned:"left"},{field:"instrumentName",headerName:"Instrument",width:200,sortable:!0,filter:!0,tooltipField:"instrumentName"},{field:"ticker",headerName:"Ticker",width:100,sortable:!0,filter:!0,cellStyle:{fontFamily:"monospace",fontWeight:"bold"}},{field:"instrumentType",headerName:"Type",width:120,sortable:!0,filter:!0,hide:!0},{field:"unitAmount",headerName:"Units",width:120,sortable:!0,filter:"agNumberColumnFilter",type:"numericColumn",valueFormatter:e=>d(e.value),cellStyle:{textAlign:"right",fontFamily:"monospace"}},{field:"boughtValue",headerName:"Bought Value",width:130,sortable:!0,filter:"agNumberColumnFilter",type:"numericColumn",valueFormatter:e=>c(e.value),cellStyle:{textAlign:"right",fontFamily:"monospace"}},{field:"currentValue",headerName:"Current Value",width:140,sortable:!0,filter:"agNumberColumnFilter",type:"numericColumn",valueFormatter:e=>c(e.value),cellStyle:e=>({textAlign:"right",fontFamily:"monospace",fontWeight:"bold",color:e.value>0?"#10b981":"#ef4444"})},{field:"gainLoss",headerName:"Gain/Loss",width:130,sortable:!0,filter:"agNumberColumnFilter",type:"numericColumn",valueFormatter:e=>c(e.value),cellStyle:e=>({textAlign:"right",fontFamily:"monospace",fontWeight:"bold",color:e.value>=0?"#10b981":"#ef4444"})},{field:"gainLossPercentage",headerName:"Gain/Loss %",width:120,sortable:!0,filter:"agNumberColumnFilter",type:"numericColumn",valueFormatter:e=>"".concat(d(e.value),"%"),cellStyle:e=>({textAlign:"right",fontFamily:"monospace",fontWeight:"bold",color:e.value>=0?"#10b981":"#ef4444"})},{field:"platformName",headerName:"Platform",width:130,sortable:!0,filter:!0},{field:"valuationDate",headerName:"Valuation Date",width:140,sortable:!0,filter:"agDateColumnFilter",valueFormatter:e=>m(e.value)}],x=e=>e.reduce((e,t)=>e+t.currentValue,0);var u=s(370),f=s(1047),g=s(7168);s(4868),s(3893);let p=e=>{let{accountId:t}=e,[s,n]=(0,r.useState)([]),[i,d]=(0,r.useState)(!1),[m,p]=(0,r.useState)(null),[b,y]=(0,r.useState)(new Date().toISOString().split("T")[0]),j=(0,r.useCallback)(async()=>{d(!0),p(null);try{let e=await o.getHoldings(t,b);e.error?(p(e.error),n([])):n(e.data||[])}catch(e){p("Failed to fetch holdings"),n([])}finally{d(!1)}},[t,b]);(0,r.useEffect)(()=>{j()},[j]);let N=x(s);return s.length,(0,a.jsxs)("div",{className:"w-full h-full bg-white",children:[(0,a.jsx)("div",{className:"bg-gradient-to-r from-primary-600 to-primary-700 p-4 text-white",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(u.Z,{className:"h-6 w-6"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-bold",children:"Portfolio Holdings"}),(0,a.jsxs)("p",{className:"text-primary-100 text-sm",children:["Account: ",t]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(f.Z,{className:"h-4 w-4"}),(0,a.jsx)("input",{type:"date",value:b,onChange:e=>y(e.target.value),className:"bg-transparent border-b border-white/30 text-white text-sm focus:border-white focus:outline-none"})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"text-xs text-primary-100",children:"Total Value"}),(0,a.jsx)("p",{className:"text-lg font-bold",children:c(N)})]}),(0,a.jsxs)("button",{onClick:j,disabled:i,className:"flex items-center space-x-2 bg-white/20 hover:bg-white/30 px-3 py-2 rounded-lg transition-colors duration-200",children:[(0,a.jsx)(g.Z,{className:"h-4 w-4 ".concat(i?"animate-spin":"")}),(0,a.jsx)("span",{className:"text-sm",children:"Refresh"})]})]})]})}),(0,a.jsxs)("div",{className:"w-full h-[calc(100%-80px)] flex flex-col",children:[m&&(0,a.jsx)("div",{className:"mx-4 mt-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-red-700",children:[(0,a.jsx)("svg",{className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),(0,a.jsxs)("span",{className:"font-medium text-sm",children:["Error: ",m]})]})}),(0,a.jsx)("div",{className:"flex-1 w-full px-4 pb-4",children:(0,a.jsx)("div",{className:"ag-theme-alpine w-full h-full",children:(0,a.jsx)(l.s,{rowData:s,columnDefs:h(),defaultColDef:{sortable:!0,filter:!0,resizable:!0,minWidth:120,flex:1},pagination:!0,paginationPageSize:50,rowSelection:"multiple",suppressHorizontalScroll:!1,alwaysShowHorizontalScroll:!1,suppressColumnVirtualisation:!1,maintainColumnOrder:!0})})}),s.length>0&&(0,a.jsx)("div",{className:"px-4 pb-4",children:(0,a.jsx)("div",{className:"bg-gray-50 rounded-lg p-3",children:(0,a.jsxs)("div",{className:"flex justify-between items-center text-sm text-gray-600",children:[(0,a.jsxs)("span",{children:["Showing ",s.length," holdings"]}),(0,a.jsxs)("span",{className:"font-semibold",children:["Total Portfolio Value: ",(0,a.jsx)("span",{className:"text-green-600 text-base",children:c(N)})]})]})})})]})]})};var b=s(236),y=s(3260),j=s(5846),N=s(4401),w=s(525),v=s(3085),k=s(2369),A=s(2222),S=s(9322),C=s(1723),I=s(4743);function E(e){let{accountId:t,className:s="",isVisible:l=!0}=e,[n,i]=(0,r.useState)({messages:[{id:"1",type:"system",content:'Welcome! I\'m your AI portfolio assistant. Ask me anything about your portfolio, such as:\n        \n• "How is my portfolio performing today?"\n• "What are my top holdings?"\n• "Show me market sentiment for my stocks"\n• "Compare my performance from last week"\n        \nI can analyze your holdings, market conditions, and provide insights to help you make informed decisions.',timestamp:new Date}],isLoading:!1}),[c,d]=(0,r.useState)(""),m=(0,r.useRef)(null),h=(0,r.useRef)(null),x=()=>{var e;null===(e=m.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})};(0,r.useEffect)(()=>{x()},[n.messages]),(0,r.useEffect)(()=>{l&&setTimeout(()=>x(),100)},[l]);let u=()=>"msg_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),f=async e=>{if(e.preventDefault(),!c.trim()||n.isLoading)return;let s={id:u(),type:"user",content:c.trim(),timestamp:new Date},a=u(),r={id:a,type:"ai",content:"",timestamp:new Date,isLoading:!0};i(e=>({...e,messages:[...e.messages,s,r],isLoading:!0}));let l=c.trim();d("");let m="",h=!0;try{await o.sendChatQueryStream(l,t,e=>{m+=e,i(e=>({...e,messages:e.messages.map(e=>e.id===a?{...e,content:m,isLoading:!1}:e)}))},()=>{i(e=>({...e,isLoading:!1,error:void 0}))},async e=>{console.warn("Streaming failed, falling back to regular API:",e),h=!1;try{var s,r,n,c;let e=await o.sendChatQuery(l,t);if(e.error)throw Error(e.error);let d={id:a,type:"ai",content:(null===(s=e.data)||void 0===s?void 0:s.response)||"I apologize, but I couldn't process your request.",timestamp:new Date,queryType:null===(r=e.data)||void 0===r?void 0:r.queryType,portfolioSummary:null===(n=e.data)||void 0===n?void 0:n.portfolioSummary,insights:null===(c=e.data)||void 0===c?void 0:c.insights};i(e=>({...e,messages:e.messages.map(e=>e.id===a?d:e),isLoading:!1,error:void 0}))}catch(t){let e={id:a,type:"ai",content:"I apologize, but I encountered an error: ".concat(t instanceof Error?t.message:"Unknown error"),timestamp:new Date,error:t instanceof Error?t.message:"Unknown error"};i(s=>({...s,messages:s.messages.map(t=>t.id===a?e:t),isLoading:!1,error:t instanceof Error?t.message:"Unknown error"}))}})}catch(t){if(!h)return;let e={id:a,type:"ai",content:"I apologize, but I encountered an error: ".concat(t instanceof Error?t.message:"Unknown error"),timestamp:new Date,error:t instanceof Error?t.message:"Unknown error"};i(s=>({...s,messages:s.messages.map(t=>t.id===a?e:t),isLoading:!1,error:t instanceof Error?t.message:"Unknown error"}))}},g=e=>new Intl.NumberFormat("en-GB",{style:"currency",currency:"GBP",minimumFractionDigits:2}).format(e),p=e=>"".concat(e>=0?"+":"").concat((100*e).toFixed(2),"%"),E=(e,t)=>(0,a.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mt-2",children:(0,a.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,a.jsx)(j.Z,{className:"h-4 w-4 text-blue-600 mt-0.5 flex-shrink-0"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("h4",{className:"font-medium text-blue-900 text-sm",children:e.title}),(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("High"===e.impact?"bg-red-100 text-red-800":"Medium"===e.impact?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"),children:e.impact})]}),(0,a.jsx)("p",{className:"text-blue-800 text-sm mt-1",children:e.description}),(0,a.jsx)("span",{className:"text-blue-600 text-xs mt-1 block",children:e.category})]})]})},t),P=e=>(0,a.jsxs)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 mt-3",children:[(0,a.jsxs)("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center",children:[(0,a.jsx)(N.Z,{className:"h-4 w-4 mr-2"}),"Portfolio Summary"]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Total Value"}),(0,a.jsx)("p",{className:"font-bold text-lg",children:g(e.totalValue)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Day Change"}),(0,a.jsxs)("p",{className:"font-bold text-lg flex items-center ".concat(e.dayChange>=0?"text-green-600":"text-red-600"),children:[e.dayChange>=0?(0,a.jsx)(w.Z,{className:"h-4 w-4 mr-1"}):(0,a.jsx)(v.Z,{className:"h-4 w-4 mr-1"}),g(e.dayChange)," (",p(e.dayChangePercentage),")"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Holdings Count"}),(0,a.jsx)("p",{className:"font-bold",children:e.holdingsCount})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Date"}),(0,a.jsx)("p",{className:"font-bold",children:new Date(e.date).toLocaleDateString()})]})]}),e.topHoldings&&e.topHoldings.length>0&&(0,a.jsxs)("div",{className:"mt-3",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:"Top Holdings"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:e.topHoldings.map((e,t)=>(0,a.jsx)("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs font-medium",children:e},t))})]})]});return(0,a.jsxs)("div",{className:"flex flex-col h-full bg-white ".concat(s),children:[(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50",children:[n.messages.map(e=>{let t="user"===e.type,s="system"===e.type;return(0,a.jsx)("div",{className:"flex ".concat(t?"justify-end":"justify-start"," mb-4"),children:(0,a.jsxs)("div",{className:"flex items-start space-x-2 max-w-[95%] ".concat(t?"flex-row-reverse space-x-reverse":""),children:[(0,a.jsx)("div",{className:"flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center ".concat(t?"bg-blue-600 text-white":s?"bg-gray-500 text-white":"bg-green-600 text-white"),children:t?(0,a.jsx)(k.Z,{className:"h-4 w-4"}):(0,a.jsx)(A.Z,{className:"h-4 w-4"})}),(0,a.jsx)("div",{className:"rounded-xl px-4 py-3 ".concat(t?"bg-blue-600 text-white":s?"bg-gray-100 text-gray-800 border":e.error?"bg-red-50 text-red-800 border border-red-200":"bg-white text-gray-800 border shadow-sm"),children:e.isLoading?(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"animate-spin h-4 w-4 border-2 border-gray-300 border-t-blue-600 rounded-full"}),(0,a.jsx)("span",{className:"text-sm",children:"Thinking..."})]}):(0,a.jsxs)(a.Fragment,{children:[e.error&&(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,a.jsx)(S.Z,{className:"h-4 w-4 text-red-600"}),(0,a.jsx)("span",{className:"text-sm font-medium text-red-800",children:"Error"})]}),(0,a.jsx)("div",{className:"prose prose-sm max-w-none",children:t?(0,a.jsx)("div",{className:"whitespace-pre-wrap text-white",children:e.content}):(0,a.jsx)(b.UG,{remarkPlugins:[y.Z],components:{table:e=>{let{children:t}=e;return(0,a.jsx)("div",{className:"chat-table-container",children:(0,a.jsx)("table",{className:"chat-table",children:t})})},thead:e=>{let{children:t}=e;return(0,a.jsx)("thead",{children:t})},tbody:e=>{let{children:t}=e;return(0,a.jsx)("tbody",{children:t})},tr:e=>{let{children:t}=e;return(0,a.jsx)("tr",{children:t})},th:e=>{let{children:t}=e;return(0,a.jsx)("th",{children:t})},td:e=>{let{children:t}=e;return(0,a.jsx)("td",{children:t})},h1:e=>{let{children:t}=e;return(0,a.jsx)("h1",{className:"text-xl font-bold text-gray-900 mb-3",children:t})},h2:e=>{let{children:t}=e;return(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:t})},h3:e=>{let{children:t}=e;return(0,a.jsx)("h3",{className:"text-md font-medium text-gray-900 mb-2",children:t})},p:e=>{let{children:t}=e;return(0,a.jsx)("p",{className:"mb-2 text-gray-800",children:t})},strong:e=>{let{children:t}=e;return(0,a.jsx)("strong",{className:"font-semibold text-gray-900",children:t})},ul:e=>{let{children:t}=e;return(0,a.jsx)("ul",{className:"list-disc list-inside mb-2 space-y-1",children:t})},ol:e=>{let{children:t}=e;return(0,a.jsx)("ol",{className:"list-decimal list-inside mb-2 space-y-1",children:t})},li:e=>{let{children:t}=e;return(0,a.jsx)("li",{className:"text-gray-800",children:t})},code:e=>{var t;let{children:s,...r}=e;return(null===(t=r.className)||void 0===t?void 0:t.includes("inline"))||!r.className?(0,a.jsx)("code",{className:"bg-gray-100 text-gray-800 px-1 py-0.5 rounded text-sm font-mono",children:s}):(0,a.jsx)("pre",{className:"bg-gray-100 text-gray-800 p-3 rounded-lg overflow-x-auto",children:(0,a.jsx)("code",{className:"text-sm font-mono",children:s})})},blockquote:e=>{let{children:t}=e;return(0,a.jsx)("blockquote",{className:"border-l-4 border-blue-500 pl-4 italic text-gray-700 my-2",children:t})}},children:e.content})}),e.portfolioSummary&&P(e.portfolioSummary),e.insights&&e.insights.length>0&&(0,a.jsxs)("div",{className:"mt-3",children:[(0,a.jsxs)("h4",{className:"font-medium text-gray-900 mb-2 flex items-center",children:[(0,a.jsx)(j.Z,{className:"h-4 w-4 mr-2"}),"Insights"]}),e.insights.map(E)]}),(0,a.jsxs)("div",{className:"text-xs mt-2 flex items-center ".concat(t?"text-blue-200":"text-gray-500"),children:[(0,a.jsx)(C.Z,{className:"h-3 w-3 mr-1"}),e.timestamp.toLocaleTimeString(),e.queryType&&(0,a.jsx)("span",{className:"ml-2 bg-gray-200 text-gray-700 px-2 py-0.5 rounded-full",children:e.queryType})]})]})})]})},e.id)}),(0,a.jsx)("div",{ref:m})]}),(0,a.jsxs)("div",{className:"border-t border-gray-200 p-4 bg-white",children:[(0,a.jsxs)("form",{onSubmit:f,className:"flex space-x-3",children:[(0,a.jsx)("input",{ref:h,type:"text",value:c,onChange:e=>d(e.target.value),placeholder:"Ask me about your portfolio...",disabled:n.isLoading,className:"flex-1 border border-gray-300 rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed text-base"}),(0,a.jsx)("button",{type:"submit",disabled:n.isLoading||!c.trim(),className:"bg-blue-600 text-white px-6 py-3 rounded-xl hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors font-medium",children:(0,a.jsx)(I.Z,{className:"h-5 w-5"})})]}),n.error&&(0,a.jsxs)("div",{className:"mt-3 text-sm text-red-600 flex items-center",children:[(0,a.jsx)(S.Z,{className:"h-4 w-4 mr-1"}),n.error]})]})]})}var P=s(6215),T=s(3417);function F(e){let{id:t,label:s,icon:r,isActive:l,onClick:n}=e;return(0,a.jsxs)("button",{onClick:n,className:"flex items-center space-x-2 px-6 py-3 rounded-lg font-medium transition-all duration-200 ".concat(l?"bg-blue-600 text-white shadow-lg":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"),children:[r,(0,a.jsx)("span",{children:s})]})}function D(e){let{accountId:t}=e,[s,l]=(0,r.useState)("holdings");return(0,a.jsxs)("div",{className:"w-full h-full flex flex-col",children:[(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsxs)("div",{className:"flex space-x-2 bg-gray-50 p-2 rounded-lg inline-flex",children:[(0,a.jsx)(F,{id:"holdings",label:"Portfolio Holdings",icon:(0,a.jsx)(P.Z,{className:"h-4 w-4"}),isActive:"holdings"===s,onClick:()=>l("holdings")}),(0,a.jsx)(F,{id:"chat",label:"AI Assistant",icon:(0,a.jsx)(T.Z,{className:"h-4 w-4"}),isActive:"chat"===s,onClick:()=>l("chat")})]})}),(0,a.jsxs)("div",{className:"flex-1 bg-white rounded-xl shadow-lg overflow-hidden",children:[(0,a.jsxs)("div",{className:"holdings"===s?"block h-full":"hidden",children:[(0,a.jsx)("div",{className:"bg-gray-50 border-b border-gray-200 p-6",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(P.Z,{className:"h-6 w-6 text-blue-600"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Portfolio Holdings"}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["View and manage your portfolio holdings for Account ",t]})]})]})}),(0,a.jsx)("div",{className:"h-[calc(100vh-12rem)]",children:(0,a.jsx)(p,{accountId:t})})]}),(0,a.jsxs)("div",{className:"chat"===s?"block h-full":"hidden",children:[(0,a.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white p-6",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(T.Z,{className:"h-6 w-6"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"AI Portfolio Assistant"}),(0,a.jsxs)("p",{className:"text-blue-100 text-sm mt-1",children:["Ask questions about your portfolio and get AI-powered insights for Account ",t]})]})]})}),(0,a.jsx)("div",{className:"h-[calc(100vh-12rem)]",children:(0,a.jsx)(E,{accountId:t,isVisible:"chat"===s})})]})]})]})}var L=s(8420),U=s(1671),Z=s(257);function H(){let[e,t]=(0,r.useState)("checking"),[s,l]=(0,r.useState)("checking");return(0,r.useEffect)(()=>{(async()=>{try{let e=await o.testConnection();t(e?"online":"offline");let s=await o.getChatHealthStatus();l(s.error?"offline":"online")}catch(e){t("offline"),l("offline")}})()},[]),(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-financial-gray-50 to-financial-gray-100",children:[(0,a.jsx)("header",{className:"bg-white shadow-financial border-b border-financial-gray-200",children:(0,a.jsx)("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(L.Z,{className:"h-8 w-8 text-primary-600"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-financial-gray-900",children:"Portfolio Manager"}),(0,a.jsx)("p",{className:"text-sm text-financial-gray-500",children:"AI-Powered Investment Management"})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:["checking"===e&&(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-financial-gray-500",children:[(0,a.jsx)("div",{className:"animate-spin h-4 w-4 border-2 border-financial-gray-300 border-t-primary-600 rounded-full"}),(0,a.jsx)("span",{className:"text-sm",children:"Checking API..."})]}),"online"===e&&(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-financial-green",children:[(0,a.jsx)(U.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"API Online"})]}),"offline"===e&&(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-financial-red",children:[(0,a.jsx)(S.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"API Offline"})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:["checking"===s&&(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-financial-gray-500",children:[(0,a.jsx)("div",{className:"animate-spin h-4 w-4 border-2 border-financial-gray-300 border-t-blue-600 rounded-full"}),(0,a.jsx)("span",{className:"text-sm",children:"Checking AI..."})]}),"online"===s&&(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-blue-600",children:[(0,a.jsx)(A.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"AI Online"})]}),"offline"===s&&(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-financial-red",children:[(0,a.jsx)(S.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"AI Offline"})]})]})]})]})})}),(0,a.jsxs)("main",{className:"w-full px-4 sm:px-6 lg:px-8 py-8",children:[("offline"===e||"offline"===s)&&(0,a.jsxs)("div",{className:"mb-8 space-y-4",children:["offline"===e&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-xl p-6",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(S.Z,{className:"h-6 w-6 text-red-500"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-red-800",children:"API Connection Error"}),(0,a.jsx)("p",{className:"text-red-600 mt-1",children:"Unable to connect to the Portfolio Manager API. Portfolio data may not be available."}),(0,a.jsxs)("p",{className:"text-sm text-red-500 mt-2",children:["Expected API endpoint: ",Z.env.NEXT_PUBLIC_API_BASE_URL||"http://localhost:8080"]})]})]})}),"offline"===s&&(0,a.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-6",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(A.Z,{className:"h-6 w-6 text-yellow-600"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-yellow-800",children:"AI Assistant Unavailable"}),(0,a.jsx)("p",{className:"text-yellow-700 mt-1",children:"The AI assistant is currently offline. Chat functionality will be limited."}),(0,a.jsx)("p",{className:"text-sm text-yellow-600 mt-2",children:"Portfolio data will still be available if the main API is online."})]})]})})]}),(0,a.jsx)("div",{className:"w-full h-auto",children:(0,a.jsx)(D,{accountId:1})})]})]})}}},function(e){e.O(0,[292,884,314,949,971,117,744],function(){return e(e.s=3162)}),_N_E=e.O()}]);