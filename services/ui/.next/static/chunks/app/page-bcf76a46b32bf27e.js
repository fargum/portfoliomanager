(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{3162:function(e,t,s){Promise.resolve().then(s.bind(s,9041))},9041:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return $}});var l=s(7437),a=s(2265),r=s(891),n=s(3227);let i=e=>new Intl.NumberFormat("en-GB",{style:"currency",currency:"GBP",minimumFractionDigits:2,maximumFractionDigits:2}).format(e),c=e=>new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:4}).format(e),o=e=>new Date(e).toLocaleDateString("en-GB",{year:"numeric",month:"short",day:"numeric"}),d=e=>[{headerName:"",checkboxSelection:!0,headerCheckboxSelection:!0,width:50,minWidth:50,maxWidth:50,resizable:!1,sortable:!1,filter:!1,pinned:"left"},{field:"platformName",headerName:"Platform",width:130,sortable:!0,filter:!0,pinned:"left"},{field:"instrumentName",headerName:"Instrument",width:200,sortable:!0,filter:!0,tooltipField:"instrumentName"},{field:"ticker",headerName:"Ticker",width:100,sortable:!0,filter:!0,cellStyle:{fontFamily:"monospace",fontWeight:"bold"}},{field:"instrumentType",headerName:"Type",width:120,sortable:!0,filter:!0,hide:!0},{field:"unitAmount",headerName:"Units",width:120,sortable:!0,filter:"agNumberColumnFilter",type:"numericColumn",editable:!0,cellEditor:"agNumberCellEditor",cellEditorParams:{min:1e-4,max:999999999,precision:4,step:1e-4},valueFormatter:e=>c(e.value),cellStyle:e=>{var t;return{textAlign:"right",fontFamily:"monospace",backgroundColor:(null===(t=e.node)||void 0===t?void 0:t.isRowPinned())?"transparent":"#f8fafc",border:"1px solid #e2e8f0",cursor:"pointer"}},onCellValueChanged:e,cellClass:"editable-cell"},{field:"boughtValue",headerName:"Bought Value",width:130,sortable:!0,filter:"agNumberColumnFilter",type:"numericColumn",valueFormatter:e=>i(e.value),cellStyle:{textAlign:"right",fontFamily:"monospace"}},{field:"currentValue",headerName:"Current Value",width:140,sortable:!0,filter:"agNumberColumnFilter",type:"numericColumn",valueFormatter:e=>i(e.value),cellStyle:e=>({textAlign:"right",fontFamily:"monospace",fontWeight:"bold",color:e.value>0?"#10b981":"#ef4444"})},{field:"gainLoss",headerName:"Gain/Loss",width:130,sortable:!0,filter:"agNumberColumnFilter",type:"numericColumn",valueFormatter:e=>i(e.value),cellStyle:e=>({textAlign:"right",fontFamily:"monospace",fontWeight:"bold",color:e.value>=0?"#10b981":"#ef4444"})},{field:"gainLossPercentage",headerName:"Gain/Loss %",width:120,sortable:!0,filter:"agNumberColumnFilter",type:"numericColumn",valueFormatter:e=>"".concat(c(e.value),"%"),cellStyle:e=>({textAlign:"right",fontFamily:"monospace",fontWeight:"bold",color:e.value>=0?"#10b981":"#ef4444"})},{field:"dailyProfitLoss",headerName:"Daily P/L",width:120,sortable:!0,filter:"agNumberColumnFilter",type:"numericColumn",valueFormatter:e=>i(e.value),cellStyle:e=>({textAlign:"right",fontFamily:"monospace",fontWeight:"bold",color:e.value>=0?"#10b981":"#ef4444",backgroundColor:e.value>=0?"#f0f9ff":"#fef2f2"})},{field:"dailyProfitLossPercentage",headerName:"Daily P/L %",width:120,sortable:!0,filter:"agNumberColumnFilter",type:"numericColumn",valueFormatter:e=>"".concat(c(e.value),"%"),cellStyle:e=>({textAlign:"right",fontFamily:"monospace",fontWeight:"bold",color:e.value>=0?"#10b981":"#ef4444",backgroundColor:e.value>=0?"#f0f9ff":"#fef2f2"})},{field:"valuationDate",headerName:"Valuation Date",width:140,sortable:!0,filter:"agDateColumnFilter",valueFormatter:e=>o(e.value)}],m=e=>e.reduce((e,t)=>e+t.currentValue,0),x=e=>e.reduce((e,t)=>e+t.boughtValue,0),u=e=>e.reduce((e,t)=>e+t.gainLoss,0),h=e=>{if(0===e.length)return 0;let t=x(e),s=u(e);return 0!==t?s/t*100:0},g=e=>e.reduce((e,t)=>e+t.dailyProfitLoss,0),f=e=>{if(0===e.length)return 0;let t=g(e),s=m(e);return 0!==s?t/s*100:0};var p=s(370),b=s(1047),j=s(7168),y=s(9397),N=s(8930),v=s(2489);s(4868),s(3893);let w=()=>{let[e,t]=(0,a.useState)([]),[s,c]=(0,a.useState)(!1),[o,v]=(0,a.useState)(null),[w,C]=(0,a.useState)(new Set),[S,A]=(0,a.useState)([]),[F,I]=(0,a.useState)(!1),[P,U]=(0,a.useState)(!1),[D,Z]=(0,a.useState)(!1),[L,E]=(0,a.useState)(new Date().toISOString().split("T")[0]),[q,T]=(0,a.useState)(0),[H,z]=(0,a.useState)(0),[V,R]=(0,a.useState)(null),[G,B]=(0,a.useState)(!1),[O,W]=(0,a.useState)([]),_=(0,a.useCallback)(async()=>{c(!0),v(null);try{let e=await n.x.getHoldings(L);e.error?(v(e.error),t([])):t(e.data||[])}catch(e){v("Failed to fetch holdings"),t([])}finally{c(!1)}},[L]),M=(0,a.useCallback)(()=>{if(!V)return;let e=0,t=0;V.forEachNodeAfterFilter(s=>{s.data&&(e+=s.data.currentValue||0,t++)}),T(e),z(t)},[V]),$=(0,a.useCallback)(e=>{R(e.api),setTimeout(()=>{let t=0,s=0;e.api.forEachNodeAfterFilter(e=>{e.data&&(t+=e.data.currentValue||0,s++)}),T(t),z(s)},100)},[]),Q=(0,a.useCallback)(()=>{M()},[M]);(0,a.useEffect)(()=>{M()},[e,M]);let J=(0,a.useCallback)(async e=>{let{data:t,newValue:s,oldValue:l,colDef:a}=e;if("unitAmount"!==a.field||s===l)return;if(s<=0||isNaN(s)){v("Units must be a positive number"),t.unitAmount=l,e.api.refreshCells({rowNodes:[e.node],force:!0});return}let r=t.holdingId;try{C(e=>new Set([...Array.from(e),r]));let a=await n.x.updateHoldingUnits(r,s);if(a.error)v("Failed to update units: ".concat(a.error)),t.unitAmount=l,e.api.refreshCells({rowNodes:[e.node],force:!0});else{await _();let e="Successfully updated ".concat(t.ticker," units to ").concat(s.toFixed(4));console.log(e),setTimeout(()=>{o===e&&v(null)},3e3)}}catch(s){v("Error updating units: ".concat(s instanceof Error?s.message:"Unknown error")),t.unitAmount=l,e.api.refreshCells({rowNodes:[e.node],force:!0})}finally{C(e=>{let t=new Set(Array.from(e));return t.delete(r),t})}},[_,o]),Y=(0,a.useCallback)(e=>{A(e.api.getSelectedRows())},[]),K=(0,a.useCallback)(async()=>{if(0===S.length)return;let e="Are you sure you want to delete ".concat(S.length," holding").concat(S.length>1?"s":"","?\n\nThis will permanently remove:\n").concat(S.map(e=>"• ".concat(e.ticker," (").concat(e.unitAmount.toFixed(4)," units)")).slice(0,5).join("\n")).concat(S.length>5?"\n• ... and ".concat(S.length-5," more"):"");if(!window.confirm(e))return;I(!0);let t=S.map(e=>e.holdingId),s=[],l=0;try{for(let e of t)try{let t=await n.x.deleteHolding(e);if(t.error){let l=S.find(t=>t.holdingId===e);s.push("".concat((null==l?void 0:l.ticker)||e,": ").concat(t.error))}else l++}catch(l){let t=S.find(t=>t.holdingId===e);s.push("".concat((null==t?void 0:t.ticker)||e,": ").concat(l instanceof Error?l.message:"Unknown error"))}l>0&&console.log("Successfully deleted ".concat(l," holding").concat(l>1?"s":"")),s.length>0?v("Failed to delete some holdings:\n".concat(s.slice(0,3).join("\n")).concat(s.length>3?"\n... and ".concat(s.length-3," more errors"):"")):l>0&&v(null),await _(),A([])}finally{I(!1)}},[S,_]),X=(0,a.useCallback)(async e=>{Z(!0);try{let t=await n.x.addHolding(1,{platformId:1,ticker:e.ticker,units:e.units,boughtValue:0,instrumentName:e.ticker,description:e.description||"".concat(e.ticker," holding"),currencyCode:e.currencyCode||"GBP",quoteUnit:e.quoteUnit||"p"});if(t.error)return v("Failed to add holding: ".concat(t.error)),!1;return await _(),v(null),console.log("Successfully added ".concat(e.ticker," with ").concat(e.units," units")),!0}catch(e){return v("Error adding holding: ".concat(e instanceof Error?e.message:"Unknown error")),!1}finally{Z(!1)}},[_]);(0,a.useEffect)(()=>{_()},[_]);let ee=m(e);x(e);let et=u(e),es=h(e),el=g(e),ea=f(e);return e.length,(0,l.jsxs)("div",{className:"w-full h-full bg-white",children:[(0,l.jsx)("div",{className:"bg-gradient-to-r from-primary-600 to-primary-700 p-4 text-white",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)(p.Z,{className:"h-6 w-6"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-lg font-bold",children:"Portfolio Holdings"}),(0,l.jsx)("p",{className:"text-primary-100 text-sm",children:"Authenticated User's Holdings"})]})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(b.Z,{className:"h-4 w-4"}),(0,l.jsx)("input",{type:"date",value:L,onChange:e=>E(e.target.value),className:"bg-transparent border-b border-white/30 text-white text-sm focus:border-white focus:outline-none"})]}),(0,l.jsx)("div",{className:"text-right",children:(0,l.jsxs)("div",{className:"flex items-baseline space-x-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("p",{className:"text-xs text-primary-100",children:[H!==e.length?"Filtered":"Total"," Value"]}),(0,l.jsx)("p",{className:"text-xl font-bold",children:i(q>0?q:ee)}),H!==e.length&&(0,l.jsxs)("p",{className:"text-xs text-primary-200",children:["Total: ",i(ee)]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-xs text-primary-100",children:"Total P&L"}),(0,l.jsx)("p",{className:"text-sm font-bold ".concat(et>=0?"text-green-200":"text-red-200"),children:i(et)}),(0,l.jsxs)("p",{className:"text-xs ".concat(es>=0?"text-green-200":"text-red-200"),children:["(",es>=0?"+":"",es.toFixed(2),"%)"]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-xs text-primary-100",children:"Daily P&L"}),(0,l.jsx)("p",{className:"text-sm font-bold ".concat(el>=0?"text-green-200":"text-red-200"),children:i(el)}),(0,l.jsxs)("p",{className:"text-xs ".concat(ea>=0?"text-green-200":"text-red-200"),children:["(",ea>=0?"+":"",ea.toFixed(2),"%)"]})]})]})}),(0,l.jsxs)("button",{onClick:_,disabled:s,className:"flex items-center space-x-2 bg-white/20 hover:bg-white/30 px-3 py-2 rounded-lg transition-colors duration-200",children:[(0,l.jsx)(j.Z,{className:"h-4 w-4 ".concat(s?"animate-spin":"")}),(0,l.jsx)("span",{className:"text-sm",children:"Refresh"})]}),(0,l.jsxs)("button",{onClick:()=>U(!0),disabled:s||w.size>0||F,className:"flex items-center space-x-2 bg-green-500/20 hover:bg-green-500/30 disabled:bg-green-500/10 px-3 py-2 rounded-lg transition-colors duration-200 disabled:cursor-not-allowed",children:[(0,l.jsx)(y.Z,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"text-sm",children:"Add Holding"})]}),S.length>0&&(0,l.jsx)("button",{onClick:K,disabled:F||w.size>0,className:"flex items-center space-x-2 bg-red-500/20 hover:bg-red-500/30 disabled:bg-red-500/10 px-3 py-2 rounded-lg transition-colors duration-200 disabled:cursor-not-allowed",children:F?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,l.jsx)("span",{className:"text-sm",children:"Deleting..."})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(N.Z,{className:"h-4 w-4"}),(0,l.jsxs)("span",{className:"text-sm",children:["Delete ",S.length," Selected"]})]})}),w.size>0&&(0,l.jsxs)("div",{className:"flex items-center space-x-2 bg-yellow-500/20 px-3 py-2 rounded-lg",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-white"}),(0,l.jsxs)("span",{className:"text-sm",children:["Updating ",w.size," holding",w.size>1?"s":"","..."]})]})]})]})}),(0,l.jsxs)("div",{className:"w-full h-[calc(100%-80px)] flex flex-col",children:[o&&(0,l.jsx)("div",{className:"mx-4 mt-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:(0,l.jsxs)("div",{className:"flex items-center space-x-2 text-red-700",children:[(0,l.jsx)("svg",{className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:(0,l.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),(0,l.jsxs)("span",{className:"font-medium text-sm",children:["Error: ",o]})]})}),(0,l.jsx)("div",{className:"flex-1 w-full px-4 pb-4",children:(0,l.jsx)("div",{className:"ag-theme-alpine w-full h-full",style:{minHeight:"500px"},children:(0,l.jsx)(r.s,{rowData:e,columnDefs:d(J),onGridReady:$,onFilterChanged:Q,onSelectionChanged:Y,defaultColDef:{sortable:!0,filter:!0,resizable:!0,minWidth:120,flex:1},singleClickEdit:!0,stopEditingWhenCellsLoseFocus:!0,rowSelection:"multiple",suppressRowClickSelection:!1,enableRangeSelection:!0,aggFuncs:{sum:e=>e.values.filter(e=>null!=e&&!isNaN(e)).reduce((e,t)=>e+t,0),avg:e=>{let t=e.values.filter(e=>null!=e&&!isNaN(e));return 0===t.length?0:t.reduce((e,t)=>e+t,0)/t.length},count:e=>e.values.filter(e=>null!=e).length},pagination:!0,paginationPageSize:50,suppressHorizontalScroll:!1,alwaysShowHorizontalScroll:!1,suppressColumnVirtualisation:!1,maintainColumnOrder:!0})})}),e.length>0&&(0,l.jsx)("div",{className:"px-4 pb-4",children:(0,l.jsx)("div",{className:"bg-gray-50 rounded-lg p-3",children:(0,l.jsxs)("div",{className:"flex justify-between items-center text-sm text-gray-600",children:[(0,l.jsx)("div",{className:"flex items-center space-x-4",children:(0,l.jsxs)("span",{children:["Showing ",H," of ",e.length," holdings",H!==e.length&&(0,l.jsx)("span",{className:"text-blue-600 font-medium",children:" (filtered)"})]})}),(0,l.jsxs)("div",{className:"flex items-center space-x-6",children:[H!==e.length&&(0,l.jsxs)("span",{className:"text-xs text-gray-500",children:["Total Portfolio: ",i(ee)]}),(0,l.jsxs)("span",{className:"font-semibold",children:[H!==e.length?"Filtered":"Total"," Value:",(0,l.jsx)("span",{className:"text-green-600 text-base ml-1",children:i(q>0?q:ee)})]}),(0,l.jsxs)("span",{className:"font-semibold",children:["Total P&L:",(0,l.jsxs)("span",{className:"text-base ml-1 ".concat(et>=0?"text-green-600":"text-red-600"),children:[i(et)," (",es>=0?"+":"",es.toFixed(2),"%)"]})]}),(0,l.jsxs)("span",{className:"font-semibold",children:["Daily P&L:",(0,l.jsxs)("span",{className:"text-base ml-1 ".concat(el>=0?"text-green-600":"text-red-600"),children:[i(el)," (",ea>=0?"+":"",ea.toFixed(2),"%)"]})]})]})]})})})]}),P&&(0,l.jsx)(k,{isOpen:P,onClose:()=>U(!1),onSubmit:X,isSubmitting:D})]})},k=e=>{let{isOpen:t,onClose:s,onSubmit:r,isSubmitting:i}=e,[c,o]=(0,a.useState)("ticker"),[d,m]=(0,a.useState)(""),[x,u]=(0,a.useState)(null),[h,g]=(0,a.useState)(!1),[f,p]=(0,a.useState)({units:"",currencyCode:"GBP",quoteUnit:"p",description:""}),[b,j]=(0,a.useState)({}),y=async e=>{if(e.trim()){g(!0),j({});try{var t,s;let l=await n.x.checkInstrument(e.trim().toUpperCase());if(l.error){j({ticker:l.error});return}u((null===(t=l.data)||void 0===t?void 0:t.exists)||!1),o("details"),(null===(s=l.data)||void 0===s?void 0:s.exists)||p(t=>({...t,description:"".concat(e.toUpperCase()," holdings")}))}catch(e){j({ticker:"Failed to check instrument"})}finally{g(!1)}}},N=()=>{let e={},t=parseFloat(f.units);return!f.units.trim()||isNaN(t)||t<=0?e.units="Units must be a positive number":t>999999999&&(e.units="Units cannot exceed 999,999,999"),x||(f.currencyCode.trim()||(e.currencyCode="Currency is required for new instruments"),f.quoteUnit.trim()||(e.quoteUnit="Quote unit is required for new instruments")),j(e),0===Object.keys(e).length},w=async e=>{e.preventDefault(),N()&&await r({ticker:d.trim().toUpperCase(),units:parseFloat(f.units),description:f.description,currencyCode:f.currencyCode,quoteUnit:f.quoteUnit})&&k()},k=()=>{i||(o("ticker"),m(""),u(null),p({units:"",currencyCode:"GBP",quoteUnit:"p",description:""}),j({}),s())};return t?(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,l.jsx)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:(0,l.jsxs)("div",{className:"p-6",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Add New Holding"}),(0,l.jsx)("button",{onClick:k,disabled:i,className:"text-gray-400 hover:text-gray-600 disabled:cursor-not-allowed",children:(0,l.jsx)(v.Z,{className:"h-6 w-6"})})]}),(0,l.jsxs)("form",{onSubmit:"ticker"===c?e=>{if(e.preventDefault(),!d.trim()){j({ticker:"Ticker is required"});return}if(!/^[A-Za-z0-9.\\-_]+$/.test(d.trim())){j({ticker:"Invalid ticker format"});return}y(d)}:w,className:"space-y-4",children:["ticker"===c&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"ticker",className:"block text-sm font-medium text-gray-700 mb-1",children:"Ticker Symbol *"}),(0,l.jsx)("input",{type:"text",id:"ticker",value:d,onChange:e=>m(e.target.value),className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(b.ticker?"border-red-500":"border-gray-300"),placeholder:"e.g., AAPL, MSFT, TSLA",disabled:h,maxLength:20}),b.ticker&&(0,l.jsx)("p",{className:"text-red-500 text-xs mt-1",children:b.ticker}),(0,l.jsx)("p",{className:"text-gray-500 text-xs mt-1",children:"Enter the ticker symbol to check if the instrument exists in our system"})]}),(0,l.jsxs)("div",{className:"flex space-x-3 pt-4",children:[(0,l.jsx)("button",{type:"button",onClick:k,disabled:h,className:"flex-1 px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:cursor-not-allowed disabled:bg-gray-100",children:"Cancel"}),(0,l.jsx)("button",{type:"submit",disabled:h||!d.trim(),className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-blue-400 disabled:cursor-not-allowed flex items-center justify-center",children:h?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Checking..."]}):"Next"})]})]}),"details"===c&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"bg-gray-50 p-3 rounded-md",children:[(0,l.jsx)("h4",{className:"font-medium text-gray-900",children:d}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:x?(0,l.jsx)(l.Fragment,{children:"✅ Instrument exists in our system"}):(0,l.jsx)(l.Fragment,{children:"⚠️ New instrument - additional details required"})})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"units",className:"block text-sm font-medium text-gray-700 mb-1",children:"Number of Units *"}),(0,l.jsx)("input",{type:"number",id:"units",value:f.units,onChange:e=>p({...f,units:e.target.value}),className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(b.units?"border-red-500":"border-gray-300"),placeholder:"0.0000",disabled:i,min:"0.0001",max:"999999999",step:"0.0001",autoFocus:!0}),b.units&&(0,l.jsx)("p",{className:"text-red-500 text-xs mt-1",children:b.units})]}),!x&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"currencyCode",className:"block text-sm font-medium text-gray-700 mb-1",children:"Currency *"}),(0,l.jsxs)("select",{id:"currencyCode",value:f.currencyCode,onChange:e=>p({...f,currencyCode:e.target.value}),className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(b.currencyCode?"border-red-500":"border-gray-300"),disabled:i,children:[(0,l.jsx)("option",{value:"GBP",children:"GBP (British Pound)"}),(0,l.jsx)("option",{value:"USD",children:"USD (US Dollar)"}),(0,l.jsx)("option",{value:"EUR",children:"EUR (Euro)"}),(0,l.jsx)("option",{value:"JPY",children:"JPY (Japanese Yen)"}),(0,l.jsx)("option",{value:"CAD",children:"CAD (Canadian Dollar)"}),(0,l.jsx)("option",{value:"AUD",children:"AUD (Australian Dollar)"})]}),b.currencyCode&&(0,l.jsx)("p",{className:"text-red-500 text-xs mt-1",children:b.currencyCode})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"quoteUnit",className:"block text-sm font-medium text-gray-700 mb-1",children:"Quote Unit *"}),(0,l.jsxs)("select",{id:"quoteUnit",value:f.quoteUnit,onChange:e=>p({...f,quoteUnit:e.target.value}),className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(b.quoteUnit?"border-red-500":"border-gray-300"),disabled:i,children:[(0,l.jsx)("option",{value:"p",children:"p (pence)"}),(0,l.jsx)("option",{value:"$",children:"$ (dollars)"}),(0,l.jsx)("option",{value:"€",children:"€ (euros)"}),(0,l.jsx)("option",{value:"\xa5",children:"\xa5 (yen)"}),(0,l.jsx)("option",{value:"C$",children:"C$ (CAD)"}),(0,l.jsx)("option",{value:"A$",children:"A$ (AUD)"})]}),b.quoteUnit&&(0,l.jsx)("p",{className:"text-red-500 text-xs mt-1",children:b.quoteUnit})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,l.jsx)("input",{type:"text",id:"description",value:f.description,onChange:e=>p({...f,description:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Optional description for this instrument",disabled:i,maxLength:255})]})]}),(0,l.jsxs)("div",{className:"flex space-x-3 pt-4",children:[(0,l.jsx)("button",{type:"button",onClick:()=>{o("ticker"),u(null),j({})},disabled:i,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:cursor-not-allowed disabled:bg-gray-100",children:"Back"}),(0,l.jsx)("button",{type:"button",onClick:k,disabled:i,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:cursor-not-allowed disabled:bg-gray-100",children:"Cancel"}),(0,l.jsx)("button",{type:"submit",disabled:i,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-blue-400 disabled:cursor-not-allowed flex items-center justify-center",children:i?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Adding..."]}):"Add Holding"})]})]})]})]})})}):null};var C=s(236),S=s(3260),A=s(5846),F=s(4401),I=s(525),P=s(3085),U=s(2369),D=s(2222),Z=s(9322),L=s(1723),E=s(9090),q=s(4743),T=s(4362);function H(e){let{accountId:t,className:s="",isVisible:r=!0}=e,[i,c]=(0,a.useState)(""),[o,d]=(0,a.useState)(void 0),{isAuthenticated:m,login:x}=(0,T.a)(),[u,h]=(0,a.useState)({messages:[{id:"1",type:"system",content:'Welcome! I\'m your AI portfolio assistant. Ask me anything about your portfolio, such as:\n        \n• "How is my portfolio performing today?"\n• "What are my top holdings?"\n• "Show me market sentiment for my stocks"\n• "Compare my performance from last week"\n        \nI can analyze your holdings, market conditions, and provide insights to help you make informed decisions.',timestamp:new Date}],isLoading:!1}),g=(0,a.useRef)(null),f=(0,a.useRef)(null),p=()=>{var e;null===(e=g.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})};(0,a.useEffect)(()=>{p()},[u.messages]),(0,a.useEffect)(()=>{r&&setTimeout(()=>p(),100)},[r]);let b=()=>"msg_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),j=async e=>{if(e.preventDefault(),!i.trim()||u.isLoading)return;let s={id:b(),type:"user",content:i.trim(),timestamp:new Date},l=b(),a={id:l,type:"ai",content:"",timestamp:new Date,isLoading:!0};h(e=>({...e,messages:[...e.messages,s,a],isLoading:!0}));let r=i.trim();c("");let m="",x=!0;try{await n.x.sendChatQueryStream(r,t,e=>{m+=e,h(e=>({...e,messages:e.messages.map(e=>e.id===l?{...e,content:m,isLoading:!1}:e)}))},()=>{h(e=>({...e,isLoading:!1,error:void 0}))},async e=>{console.warn("Streaming failed, falling back to regular API:",e),x=!1;try{var s,a,i,c,m;let e=await n.x.sendChatQuery(r,t,o);if(e.error)throw Error(e.error);(null===(s=e.data)||void 0===s?void 0:s.threadId)&&!o&&d(e.data.threadId);let x={id:l,type:"ai",content:(null===(a=e.data)||void 0===a?void 0:a.response)||"I apologize, but I couldn't process your request.",timestamp:new Date,queryType:null===(i=e.data)||void 0===i?void 0:i.queryType,portfolioSummary:null===(c=e.data)||void 0===c?void 0:c.portfolioSummary,insights:null===(m=e.data)||void 0===m?void 0:m.insights};h(e=>({...e,messages:e.messages.map(e=>e.id===l?x:e),isLoading:!1,error:void 0}))}catch(t){let e={id:l,type:"ai",content:"I apologize, but I encountered an error: ".concat(t instanceof Error?t.message:"Unknown error"),timestamp:new Date,error:t instanceof Error?t.message:"Unknown error"};h(s=>({...s,messages:s.messages.map(t=>t.id===l?e:t),isLoading:!1,error:t instanceof Error?t.message:"Unknown error"}))}},o)}catch(t){if(!x)return;let e={id:l,type:"ai",content:"I apologize, but I encountered an error: ".concat(t instanceof Error?t.message:"Unknown error"),timestamp:new Date,error:t instanceof Error?t.message:"Unknown error"};h(s=>({...s,messages:s.messages.map(t=>t.id===l?e:t),isLoading:!1,error:t instanceof Error?t.message:"Unknown error"}))}},y=e=>new Intl.NumberFormat("en-GB",{style:"currency",currency:"GBP",minimumFractionDigits:2}).format(e),N=e=>"".concat(e>=0?"+":"").concat((100*e).toFixed(2),"%"),v=(e,t)=>(0,l.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mt-2",children:(0,l.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,l.jsx)(A.Z,{className:"h-4 w-4 text-blue-600 mt-0.5 flex-shrink-0"}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("h4",{className:"font-medium text-blue-900 text-sm",children:e.title}),(0,l.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("High"===e.impact?"bg-red-100 text-red-800":"Medium"===e.impact?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"),children:e.impact})]}),(0,l.jsx)("p",{className:"text-blue-800 text-sm mt-1",children:e.description}),(0,l.jsx)("span",{className:"text-blue-600 text-xs mt-1 block",children:e.category})]})]})},t),w=e=>(0,l.jsxs)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 mt-3",children:[(0,l.jsxs)("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center",children:[(0,l.jsx)(F.Z,{className:"h-4 w-4 mr-2"}),"Portfolio Summary"]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Total Value"}),(0,l.jsx)("p",{className:"font-bold text-lg",children:y(e.totalValue)})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Day Change"}),(0,l.jsxs)("p",{className:"font-bold text-lg flex items-center ".concat(e.dayChange>=0?"text-green-600":"text-red-600"),children:[e.dayChange>=0?(0,l.jsx)(I.Z,{className:"h-4 w-4 mr-1"}):(0,l.jsx)(P.Z,{className:"h-4 w-4 mr-1"}),y(e.dayChange)," (",N(e.dayChangePercentage),")"]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Holdings Count"}),(0,l.jsx)("p",{className:"font-bold",children:e.holdingsCount})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Date"}),(0,l.jsx)("p",{className:"font-bold",children:new Date(e.date).toLocaleDateString()})]})]}),e.topHoldings&&e.topHoldings.length>0&&(0,l.jsxs)("div",{className:"mt-3",children:[(0,l.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:"Top Holdings"}),(0,l.jsx)("div",{className:"flex flex-wrap gap-2",children:e.topHoldings.map((e,t)=>(0,l.jsx)("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs font-medium",children:e},t))})]})]});return(0,l.jsx)("div",{className:"flex flex-col h-full bg-white ".concat(s),children:m?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50",children:[u.messages.map(e=>{let t="user"===e.type,s="system"===e.type;return(0,l.jsx)("div",{className:"flex ".concat(t?"justify-end":"justify-start"," mb-4"),children:(0,l.jsxs)("div",{className:"flex items-start space-x-2 max-w-[95%] ".concat(t?"flex-row-reverse space-x-reverse":""),children:[(0,l.jsx)("div",{className:"flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center ".concat(t?"bg-blue-600 text-white":s?"bg-gray-500 text-white":"bg-green-600 text-white"),children:t?(0,l.jsx)(U.Z,{className:"h-4 w-4"}):(0,l.jsx)(D.Z,{className:"h-4 w-4"})}),(0,l.jsx)("div",{className:"rounded-xl px-4 py-3 ".concat(t?"bg-blue-600 text-white":s?"bg-gray-100 text-gray-800 border":e.error?"bg-red-50 text-red-800 border border-red-200":"bg-white text-gray-800 border shadow-sm"),children:e.isLoading?(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("div",{className:"animate-spin h-4 w-4 border-2 border-gray-300 border-t-blue-600 rounded-full"}),(0,l.jsx)("span",{className:"text-sm",children:"Thinking..."})]}):(0,l.jsxs)(l.Fragment,{children:[e.error&&(0,l.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,l.jsx)(Z.Z,{className:"h-4 w-4 text-red-600"}),(0,l.jsx)("span",{className:"text-sm font-medium text-red-800",children:"Error"})]}),(0,l.jsx)("div",{className:"max-w-none",children:t?(0,l.jsx)("div",{className:"whitespace-pre-wrap text-white",children:e.content}):(0,l.jsx)(C.UG,{remarkPlugins:[S.Z],components:{table:e=>{let{children:t}=e;return(0,l.jsx)("div",{className:"chat-table-container",children:(0,l.jsx)("table",{className:"chat-table",children:t})})},thead:e=>{let{children:t}=e;return(0,l.jsx)("thead",{children:t})},tbody:e=>{let{children:t}=e;return(0,l.jsx)("tbody",{children:t})},tr:e=>{let{children:t}=e;return(0,l.jsx)("tr",{children:t})},th:e=>{let{children:t}=e;return(0,l.jsx)("th",{children:t})},td:e=>{let{children:t}=e;return(0,l.jsx)("td",{children:t})},h1:e=>{let{children:t}=e;return(0,l.jsx)("h1",{className:"text-xl font-bold text-gray-900 mb-3",children:t})},h2:e=>{let{children:t}=e;return(0,l.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:t})},h3:e=>{let{children:t}=e;return(0,l.jsx)("h3",{className:"text-md font-medium text-gray-900 mb-2",children:t})},p:e=>{let{children:t}=e;return(0,l.jsx)("p",{className:"mb-2 text-gray-800",children:t})},strong:e=>{let{children:t}=e;return(0,l.jsx)("strong",{className:"font-semibold text-gray-900",children:t})},ul:e=>{let{children:t}=e;return(0,l.jsx)("ul",{className:"list-disc list-outside mb-2 ml-4 space-y-0",children:t})},ol:e=>{let{children:t}=e;return(0,l.jsx)("ol",{className:"list-decimal list-outside mb-2 ml-4 space-y-0",children:t})},li:e=>{let{children:t}=e;return(0,l.jsx)("li",{className:"text-gray-800 mb-1",children:t})},code:e=>{var t;let{children:s,...a}=e;return(null===(t=a.className)||void 0===t?void 0:t.includes("inline"))||!a.className?(0,l.jsx)("code",{className:"bg-gray-100 text-gray-800 px-1 py-0.5 rounded text-sm font-mono",children:s}):(0,l.jsx)("pre",{className:"bg-gray-100 text-gray-800 p-3 rounded-lg overflow-x-auto",children:(0,l.jsx)("code",{className:"text-sm font-mono",children:s})})},blockquote:e=>{let{children:t}=e;return(0,l.jsx)("blockquote",{className:"border-l-4 border-blue-500 pl-4 italic text-gray-700 my-2",children:t})}},children:e.content})}),e.portfolioSummary&&w(e.portfolioSummary),e.insights&&e.insights.length>0&&(0,l.jsxs)("div",{className:"mt-3",children:[(0,l.jsxs)("h4",{className:"font-medium text-gray-900 mb-2 flex items-center",children:[(0,l.jsx)(A.Z,{className:"h-4 w-4 mr-2"}),"Insights"]}),e.insights.map(v)]}),(0,l.jsxs)("div",{className:"text-xs mt-2 flex items-center ".concat(t?"text-blue-200":"text-gray-500"),children:[(0,l.jsx)(L.Z,{className:"h-3 w-3 mr-1"}),e.timestamp.toLocaleTimeString(),e.queryType&&(0,l.jsx)("span",{className:"ml-2 bg-gray-200 text-gray-700 px-2 py-0.5 rounded-full",children:e.queryType})]})]})})]})},e.id)}),(0,l.jsx)("div",{ref:g})]}),(0,l.jsxs)("div",{className:"border-t border-gray-200 p-4 bg-white",children:[(0,l.jsxs)("form",{onSubmit:j,className:"flex space-x-3",children:[(0,l.jsx)("input",{ref:f,type:"text",value:i,onChange:e=>c(e.target.value),placeholder:"Ask me about your portfolio...",disabled:u.isLoading,className:"flex-1 border border-gray-300 rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed text-base"}),(0,l.jsx)("button",{type:"submit",disabled:u.isLoading||!i.trim(),className:"bg-blue-600 text-white px-6 py-3 rounded-xl hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors font-medium",children:(0,l.jsx)(q.Z,{className:"h-5 w-5"})})]}),u.error&&(0,l.jsxs)("div",{className:"mt-3 text-sm text-red-600 flex items-center justify-between bg-red-50 p-3 rounded-lg border border-red-200",children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(Z.Z,{className:"h-4 w-4 mr-2 flex-shrink-0"}),(0,l.jsx)("span",{children:u.error})]}),(u.error.includes("sign in")||u.error.includes("Authentication"))&&(0,l.jsx)("button",{onClick:()=>window.location.reload(),className:"ml-3 bg-blue-600 text-white px-3 py-1 rounded-md text-xs hover:bg-blue-700 transition-colors",children:"Refresh Page"})]})]})]}):(0,l.jsx)("div",{className:"flex-1 flex items-center justify-center p-8",children:(0,l.jsxs)("div",{className:"text-center max-w-md",children:[(0,l.jsx)("div",{className:"w-20 h-20 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-6",children:(0,l.jsx)(D.Z,{className:"h-10 w-10 text-blue-600"})}),(0,l.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-3",children:"AI Assistant Ready"}),(0,l.jsx)("p",{className:"text-gray-600 mb-6",children:"Sign in to access your AI portfolio assistant and get personalized insights about your investments."}),(0,l.jsxs)("button",{onClick:x,className:"inline-flex items-center space-x-2 bg-blue-600 text-white px-6 py-3 rounded-xl hover:bg-blue-700 transition-colors font-medium",children:[(0,l.jsx)(E.Z,{className:"h-5 w-5"}),(0,l.jsx)("span",{children:"Sign In to Start"})]}),(0,l.jsx)("p",{className:"text-sm text-gray-500 mt-4",children:"Once authenticated, you can ask questions about your portfolio performance, holdings, and get market insights."})]})})})}var z=s(8112),V=s(8906),R=s(7692);function G(){let{inProgress:e}=(0,z.Fp)(),{isAuthenticated:t,isAcquiringToken:s,accessToken:a,userInfo:r,login:n,logout:i}=(0,T.a)();return"login"===e?(0,l.jsxs)("div",{className:"flex items-center space-x-2 text-blue-600",children:[(0,l.jsx)("div",{className:"animate-spin h-4 w-4 border-2 border-blue-600 border-t-transparent rounded-full"}),(0,l.jsx)("span",{className:"text-sm",children:"Signing in..."})]}):s?(0,l.jsxs)("div",{className:"flex items-center space-x-2 text-blue-600",children:[(0,l.jsx)("div",{className:"animate-spin h-4 w-4 border-2 border-blue-600 border-t-transparent rounded-full"}),(0,l.jsx)("span",{className:"text-sm",children:"Getting access token..."})]}):t?(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)("div",{className:"flex items-center space-x-2",children:a?(0,l.jsxs)("div",{className:"flex items-center space-x-2 text-green-600",children:[(0,l.jsx)(V.Z,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"text-sm font-medium",children:"Authenticated"})]}):(0,l.jsxs)("div",{className:"flex items-center space-x-2 text-yellow-600",children:[(0,l.jsx)(Z.Z,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"text-sm font-medium",children:"Getting token..."})]})}),r&&(0,l.jsxs)("div",{className:"flex items-center space-x-2 text-gray-700",children:[(0,l.jsx)(U.Z,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"text-sm",children:r.name||r.email})]}),(0,l.jsxs)("button",{onClick:i,className:"flex items-center space-x-2 px-3 py-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",children:[(0,l.jsx)(R.Z,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"text-sm",children:"Sign Out"})]})]}):(0,l.jsxs)("button",{onClick:n,className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[(0,l.jsx)(E.Z,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"text-sm font-medium",children:"Sign In"})]})}var B=s(8420),O=s(6215),W=s(3417),_=s(1671);function M(e){let{id:t,label:s,icon:a,isActive:r,onClick:n}=e;return(0,l.jsxs)("button",{onClick:n,className:"flex items-center space-x-2 px-4 py-2 rounded-lg font-medium transition-all duration-200 ".concat(r?"bg-blue-600 text-white shadow-md":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"),children:[a,(0,l.jsx)("span",{className:"text-sm",children:s})]})}function $(){let[e,t]=(0,a.useState)("checking"),[s,r]=(0,a.useState)("checking"),[i,c]=(0,a.useState)("holdings"),{isAuthenticated:o}=(0,T.a)();return(0,a.useEffect)(()=>{(async()=>{console.log("Checking services, authenticated:",o);try{let e=await n.x.testConnection();if(t(e?"online":"offline"),o){r("checking");try{let e=await n.x.getChatHealthStatus();r(e.error?"offline":"online")}catch(e){console.log("AI service check failed:",e),r("offline")}}else console.log("Not authenticated, setting AI status to offline"),r("offline")}catch(e){t("offline"),r("offline")}})()},[o]),(0,l.jsxs)("div",{className:"h-screen bg-gradient-to-br from-financial-gray-50 to-financial-gray-100 flex flex-col",children:[(0,l.jsx)("header",{className:"bg-white shadow-financial border-b border-financial-gray-200 flex-shrink-0",children:(0,l.jsx)("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-4",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-8",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)(B.Z,{className:"h-8 w-8 text-primary-600"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-2xl font-bold text-financial-gray-900",children:"Portfolio Manager"}),(0,l.jsx)("p",{className:"text-sm text-financial-gray-500",children:"AI-Powered Investment Management"})]})]}),(0,l.jsxs)("div",{className:"flex space-x-2 bg-gray-50 p-1 rounded-lg",children:[(0,l.jsx)(M,{id:"holdings",label:"Portfolio Holdings",icon:(0,l.jsx)(O.Z,{className:"h-4 w-4"}),isActive:"holdings"===i,onClick:()=>c("holdings")}),(0,l.jsx)(M,{id:"chat",label:"AI Assistant",icon:(0,l.jsx)(W.Z,{className:"h-4 w-4"}),isActive:"chat"===i,onClick:()=>c("chat")})]})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,l.jsx)(G,{}),(0,l.jsx)("div",{className:"h-6 w-px bg-gray-300"}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[!o&&(0,l.jsxs)("div",{className:"flex items-center space-x-2 text-financial-gray-400",children:[(0,l.jsx)(B.Z,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"text-sm",children:"API (Auth Required)"})]}),o&&"checking"===e&&(0,l.jsxs)("div",{className:"flex items-center space-x-2 text-financial-gray-500",children:[(0,l.jsx)("div",{className:"animate-spin h-4 w-4 border-2 border-financial-gray-300 border-t-primary-600 rounded-full"}),(0,l.jsx)("span",{className:"text-sm",children:"Checking API..."})]}),o&&"online"===e&&(0,l.jsxs)("div",{className:"flex items-center space-x-2 text-financial-green",children:[(0,l.jsx)(_.Z,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"text-sm font-medium",children:"API Online"})]}),o&&"offline"===e&&(0,l.jsxs)("div",{className:"flex items-center space-x-2 text-financial-red",children:[(0,l.jsx)(Z.Z,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"text-sm font-medium",children:"API Offline"})]})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[!o&&(0,l.jsxs)("div",{className:"flex items-center space-x-2 text-financial-gray-400",children:[(0,l.jsx)(D.Z,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"text-sm",children:"AI (Auth Required)"})]}),o&&"checking"===s&&(0,l.jsxs)("div",{className:"flex items-center space-x-2 text-financial-gray-500",children:[(0,l.jsx)("div",{className:"animate-spin h-4 w-4 border-2 border-financial-gray-300 border-t-blue-600 rounded-full"}),(0,l.jsx)("span",{className:"text-sm",children:"Checking AI..."})]}),o&&"online"===s&&(0,l.jsxs)("div",{className:"flex items-center space-x-2 text-blue-600",children:[(0,l.jsx)(D.Z,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"text-sm font-medium",children:"AI Online"})]}),o&&"offline"===s&&(0,l.jsxs)("div",{className:"flex items-center space-x-2 text-financial-red",children:[(0,l.jsx)(Z.Z,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"text-sm font-medium",children:"AI Offline"})]})]})]})]})})}),("offline"===e||"offline"===s&&o||!o&&"chat"===i)&&(0,l.jsx)("div",{className:"flex-shrink-0 px-4 sm:px-6 lg:px-8 pt-4",children:(0,l.jsxs)("div",{className:"space-y-4",children:["offline"===e&&(0,l.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4",children:(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)(Z.Z,{className:"h-5 w-5 text-red-500"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-sm font-semibold text-red-800",children:"API Connection Error"}),(0,l.jsx)("p",{className:"text-xs text-red-600 mt-1",children:"Unable to connect to the Portfolio Manager API. Portfolio data may not be available."})]})]})}),!o&&"chat"===i&&(0,l.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4",children:(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)(D.Z,{className:"h-5 w-5 text-blue-600"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-sm font-semibold text-blue-800",children:"Authentication Required"}),(0,l.jsx)("p",{className:"text-xs text-blue-700 mt-1",children:"Please sign in to access the AI assistant and chat functionality."})]})]})}),"offline"===s&&o&&(0,l.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-4",children:(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)(D.Z,{className:"h-5 w-5 text-yellow-600"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-sm font-semibold text-yellow-800",children:"AI Assistant Unavailable"}),(0,l.jsx)("p",{className:"text-xs text-yellow-700 mt-1",children:"The AI assistant is currently offline. Chat functionality will be limited."})]})]})})]})}),(0,l.jsx)("main",{className:"flex-1 overflow-hidden px-4 sm:px-6 lg:px-8 pt-4 pb-4",children:(0,l.jsxs)("div",{className:"h-full bg-white rounded-xl shadow-lg overflow-hidden",children:[(0,l.jsxs)("div",{className:"holdings"===i?"block h-full":"hidden",children:[(0,l.jsx)("div",{className:"bg-gray-50 border-b border-gray-200 p-4",children:(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)(O.Z,{className:"h-5 w-5 text-blue-600"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Portfolio Holdings"}),(0,l.jsxs)("p",{className:"text-sm text-gray-600",children:["View and manage your portfolio holdings for Account ",1]})]})]})}),(0,l.jsx)("div",{className:"h-[calc(100%-5rem)] overflow-hidden",children:(0,l.jsx)(w,{})})]}),(0,l.jsxs)("div",{className:"chat"===i?"block h-full":"hidden",children:[(0,l.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white p-4",children:(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)(W.Z,{className:"h-5 w-5"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-lg font-semibold",children:"AI Portfolio Assistant"}),(0,l.jsxs)("p",{className:"text-blue-100 text-sm",children:["Ask questions about your portfolio and get AI-powered insights for Account ",1]})]})]})}),(0,l.jsx)("div",{className:"h-[calc(100%-5rem)] overflow-hidden",children:(0,l.jsx)(H,{accountId:1,isVisible:"chat"===i})})]})]})})]})}}},function(e){e.O(0,[292,884,314,112,270,362,971,117,744],function(){return e(e.s=3162)}),_N_E=e.O()}]);